---
title: "p8105_hw2_hy2580"
author: "haokun yuan"
date: "10/1/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

##Problem 1

Read and Clean the Data:
```{r}
nyc_transit_data = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>% 
# import data and format data with appropriate variable names
#nyc_transit_data = select(nyc_transit_data, line, station_name, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, station_latitude, station_longitude, entry, vending, entrance_type, ada)
  select(line, station_name, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, station_latitude, station_longitude, entry, vending, entrance_type, ada) %>% 
  mutate(recode(entry,`YES` = TRUE, `NO` = FALSE )) #%>% 
  #View()
# select wanted variables
#nyc_transit_data$entry = recode(nyc_transit_data$entry, `YES` = TRUE, `NO` = FALSE )

# convert the class of variable "entry" to logical
```

The nyc_transit_data dataset contains 13 variables, which are "line","station","route"


I first use janitor:clean_names to convert the names of the variable, then selected the variable we want from the original dataset and changed the value of "entry" variable to logical variable. There are `{r}ncol(nyc_transit_data)` columns and `{r}nrow(nyc_transit_data)` rows in the dataset.
The dataset is not tidy although all the column are variables, rows are observations and every value has a cell, route number is spread into 11 columns.

There are `{r}count(distinct(nyc_transit_data, station_name, line))` distinct stations.

`{r}sum(distinct(nyc_transit_data,station_name, ada)$ada, na.rm = TRUE)` stations are ADA compliant.

`{r}count(nyc_transit_data, vending)`


```{r}
nyc_transit_tidy = gather(nyc_transit_data, key = "route_number", value = "route_name", route1:route11)
# tidy nyc_transit_data
# make route number and route name distinct variables
```

```{r}
nyc_transit_a = filter(nyc_transit_tidy, route_name == "A")
#exclude all the route name except A 
```

There are `{r}count(distinct(nyc_transit_a,station_name))`distinct stations serve the A train.

Of the stations that serves A train,`{r}` of them are ADA compliant.

##Problem 2

```{r}
library(readxl)
mr_trash_wheel = read_excel("data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 1, range = cell_cols("A:N")) %>%
# import data from excel with specify sheet number = 1, omit column with notes
  janitor::clean_names() %>% 
  #clean name
  na.omit(cols = "dumpster") %>% 
  # omit rows do not include dumpster-specific data
  mutate(sports_balls = as.integer(round(sports_balls, digits = 0)))
  # round the number of sports balls.
  # convert the class of sports balls to integer.

```

```{r}
prcp_2017 = read_excel("data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 3, range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  #na.omit(total)
  mutate(year = 2016)
# import precipitation data on 2017
prcp_2016 = read_excel("data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 4, range = "A2:B15") %>% 
  janitor::clean_names() %>%
  #na.omit(cols = "total" )
  mutate(year = 2016)

# import precipitation data on 2016

prcp = left_join(prcp_2017, prcp_2016, by = "month")  
  month.name["month"]

```

##Problem 3

```{r}
# install.packages("devtools")
devtools::install_github("p8105/p8105.datasets")
library(p8105.datasets)
```

```{r}
brfss_tidy =
  brfss_smart2010 %>% 
  janitor::clean_names() %>%
  select(-class,-topic, -question, -sample_size,-(confidence_limit_low:geo_location)) %>%  
  filter(response %in% c("Excellent", "Very good", "Good", "Fair", "Poor")) %>% 
  spread(key = response, value = data_value) %>% 
  janitor::clean_names() %>% 
  mutate(excellent_verygood = (excellent + very_good)/(excellent + very_good + good + fair + poor))   
  #variable unit
  

```

```{r}
#brfss_smart2010 %>% 
  #filter(Year == 2012, Response == Excellent)
brfss_2002 = brfss_tidy %>%
  filter(year == 2002)
ggplot(brfss_2002, aes(x = excellent)) +
  geom_histogram()
```

```{r}
brfss_ny_queens = brfss_tidy %>% 
    filter(locationdesc %in% c("NY - New York County", "NY - Queens County", year %in% 2002:2010 ))
ggplot(brfss_ny_queens, aes(x = year, y = excellent, color = locationdesc)) +
  geom_point()
```



